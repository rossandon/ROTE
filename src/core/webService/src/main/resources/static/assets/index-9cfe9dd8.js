var we=Object.defineProperty;var Le=(t,e,r)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var V=(t,e,r)=>(Le(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=r(l);fetch(l.href,o)}})();function $(){}function pe(t){return t()}function le(){return Object.create(null)}function F(t){t.forEach(pe)}function he(t){return typeof t=="function"}function A(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ce(t){return Object.keys(t).length===0}function p(t,e){t.appendChild(e)}function g(t,e,r){t.insertBefore(e,r||null)}function b(t){t.parentNode&&t.parentNode.removeChild(t)}function _e(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function h(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function v(){return E(" ")}function W(){return E("")}function x(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function ee(t){return function(e){return e.preventDefault(),t.call(this,e)}}function k(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Ee(t){return Array.from(t.childNodes)}function R(t,e){e=""+e,t.data!==e&&(t.data=e)}function Oe(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}let z;function H(t){z=t}function be(){if(!z)throw new Error("Function called outside component initialization");return z}function te(t){be().$$.on_mount.push(t)}function ne(){const t=be();return(e,r,{cancelable:n=!1}={})=>{const l=t.$$.callbacks[e];if(l){const o=Oe(e,r,{cancelable:n});return l.slice().forEach(i=>{i.call(t,o)}),!o.defaultPrevented}return!0}}function oe(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}const U=[],J=[];let I=[];const Q=[],Se=Promise.resolve();let X=!1;function Ne(){X||(X=!0,Se.then($e))}function Z(t){I.push(t)}function ge(t){Q.push(t)}const Y=new Set;let M=0;function $e(){if(M!==0)return;const t=z;do{try{for(;M<U.length;){const e=U[M];M++,H(e),Pe(e.$$)}}catch(e){throw U.length=0,M=0,e}for(H(null),U.length=0,M=0;J.length;)J.pop()();for(let e=0;e<I.length;e+=1){const r=I[e];Y.has(r)||(Y.add(r),r())}I.length=0}while(U.length);for(;Q.length;)Q.pop()();X=!1,Y.clear(),H(t)}function Pe(t){if(t.fragment!==null){t.update(),F(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}function Ae(t){const e=[],r=[];I.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),I=e}const G=new Set;let N;function ye(){N={r:0,c:[],p:N}}function ke(){N.r||F(N.c),N=N.p}function w(t,e){t&&t.i&&(G.delete(t),t.i(e))}function C(t,e,r,n){if(t&&t.o){if(G.has(t))return;G.add(t),N.c.push(()=>{G.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function K(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ve(t,e,r){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}function P(t){t&&t.c()}function O(t,e,r){const{fragment:n,after_update:l}=t.$$;n&&n.m(e,r),Z(()=>{const o=t.$$.on_mount.map(pe).filter(he);t.$$.on_destroy?t.$$.on_destroy.push(...o):F(o),t.$$.on_mount=[]}),l.forEach(Z)}function S(t,e){const r=t.$$;r.fragment!==null&&(Ae(r.after_update),F(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function De(t,e){t.$$.dirty[0]===-1&&(U.push(t),Ne(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(t,e,r,n,l,o,i=null,s=[-1]){const f=z;H(t);const u=t.$$={fragment:null,ctx:[],props:o,update:$,not_equal:l,bound:le(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:le(),dirty:s,skip_bound:!1,root:e.target||f.$$.root};i&&i(u.root);let c=!1;if(u.ctx=r?r(t,e.props||{},(a,d,..._)=>{const m=_.length?_[0]:d;return u.ctx&&l(u.ctx[a],u.ctx[a]=m)&&(!u.skip_bound&&u.bound[a]&&u.bound[a](m),c&&De(t,a)),d}):[],u.update(),c=!0,F(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const a=Ee(e.target);u.fragment&&u.fragment.l(a),a.forEach(b)}else u.fragment&&u.fragment.c();e.intro&&w(t.$$.fragment),O(t,e.target,e.anchor),$e()}H(f)}class T{constructor(){V(this,"$$");V(this,"$$set")}$destroy(){S(this,1),this.$destroy=$}$on(e,r){if(!he(r))return $;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const l=n.indexOf(r);l!==-1&&n.splice(l,1)}}$set(e){this.$$set&&!Ce(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Te="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Te);function ie(t,e,r){const n=t.slice();return n[2]=e[r],n}function se(t){let e,r,n=t[2]+"",l,o,i,s=t[0][t[2]]+"",f,u;return{c(){e=h("tr"),r=h("td"),l=E(n),o=v(),i=h("td"),f=E(s),u=v()},m(c,a){g(c,e,a),p(e,r),p(r,l),p(e,o),p(e,i),p(i,f),p(e,u)},p(c,a){a&1&&n!==(n=c[2]+"")&&R(l,n),a&1&&s!==(s=c[0][c[2]]+"")&&R(f,s)},d(c){c&&b(e)}}}function Be(t){let e,r,n,l,o=K(Object.keys(t[0])),i=[];for(let s=0;s<o.length;s+=1)i[s]=se(ie(t,o,s));return{c(){e=h("table"),r=h("thead"),r.innerHTML="<tr><th>Asset</th> <th>Balance</th></tr>",n=v(),l=h("tbody");for(let s=0;s<i.length;s+=1)i[s].c()},m(s,f){g(s,e,f),p(e,r),p(e,n),p(e,l);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(l,null)},p(s,[f]){if(f&1){o=K(Object.keys(s[0]));let u;for(u=0;u<o.length;u+=1){const c=ie(s,o,u);i[u]?i[u].p(c,f):(i[u]=se(c),i[u].c(),i[u].m(l,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=o.length}},i:$,o:$,d(s){s&&b(e),_e(i,s)}}}function Me(t,e,r){let n={};function l(){fetch("balances/list").then(o=>o.json()).then(o=>r(0,n=o))}return te(()=>{l()}),[n,l]}class Ue extends T{constructor(e){super(),D(this,e,Me,Be,A,{refresh:1})}get refresh(){return this.$$.ctx[1]}}function ue(t){let e,r=t[0].name+"",n,l,o;return{c(){e=E("Hello, "),n=E(r),l=E(". "),o=h("a"),o.textContent="Logout",k(o,"href","/logout")},m(i,s){g(i,e,s),g(i,n,s),g(i,l,s),g(i,o,s)},p(i,s){s&1&&r!==(r=i[0].name+"")&&R(n,r)},d(i){i&&(b(e),b(n),b(l),b(o))}}}function Ie(t){let e,r=t[0]!=null&&ue(t);return{c(){r&&r.c(),e=W()},m(n,l){r&&r.m(n,l),g(n,e,l)},p(n,[l]){n[0]!=null?r?r.p(n,l):(r=ue(n),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null)},i:$,o:$,d(n){n&&b(e),r&&r.d(n)}}}async function je(){try{const t=await fetch("system/whoami");if(!t.ok)throw new Error(`Error! status: ${t.status}`);return await t.json()}catch(t){return t instanceof Error?(console.log("error message: ",t.message),null):(console.log("unexpected error: ",t),null)}}function He(t,e,r){let{user:n=null}=e;return te(async()=>{r(0,n=await je())}),t.$$set=l=>{"user"in l&&r(0,n=l.user)},[n]}class Re extends T{constructor(e){super(),D(this,e,He,Ie,A,{user:0})}}function ze(t){let e,r,n;return{c(){e=h("form"),e.innerHTML='<label>Asset<input type="text" name="assetCode" placeholder="USD"/></label> <label>Amount<input type="text" name="amount" placeholder="100"/></label> <input type="submit" value="Deposit"/>',k(e,"method","post"),k(e,"action","/balances/deposit")},m(l,o){g(l,e,o),r||(n=x(e,"submit",ee(t[0])),r=!0)},p:$,i:$,o:$,d(l){l&&b(e),r=!1,n()}}}function Fe(t){const e=ne();return[n=>{const l=n.target.action,o=new FormData(n.target),i=new URLSearchParams;for(let s of o){const[f,u]=s;i.append(f,u)}fetch(l,{method:"POST",body:i}).then(s=>{n.target.reset(),e("deposit",{})})}]}class We extends T{constructor(e){super(),D(this,e,Fe,ze,A,{})}}function ce(t,e,r){const n=t.slice();return n[4]=e[r],n}function qe(t){let e,r=K(t[0]),n=[];for(let l=0;l<r.length;l+=1)n[l]=ae(ce(t,r,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=W()},m(l,o){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(l,o);g(l,e,o)},p(l,o){if(o&7){r=K(l[0]);let i;for(i=0;i<r.length;i+=1){const s=ce(l,r,i);n[i]?n[i].p(s,o):(n[i]=ae(s),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},d(l){l&&b(e),_e(n,l)}}}function Ge(t){let e;return{c(){e=h("tr"),e.innerHTML='<td colspan="3">No entries.</td>'},m(r,n){g(r,e,n)},p:$,d(r){r&&b(e)}}}function Je(t){let e,r,n=t[4].price+"",l,o,i,s=t[4].size+"",f,u,c,a,d=t[4].canCancel&&fe(t);return{c(){e=h("tr"),r=h("td"),l=E(n),o=v(),i=h("td"),f=E(s),u=v(),c=h("td"),d&&d.c(),a=v()},m(_,m){g(_,e,m),p(e,r),p(r,l),p(e,o),p(e,i),p(i,f),p(e,u),p(e,c),d&&d.m(c,null),p(e,a)},p(_,m){m&1&&n!==(n=_[4].price+"")&&R(l,n),m&1&&s!==(s=_[4].size+"")&&R(f,s),_[4].canCancel?d?d.p(_,m):(d=fe(_),d.c(),d.m(c,null)):d&&(d.d(1),d=null)},d(_){_&&b(e),d&&d.d()}}}function Ke(t){let e;return{c(){e=h("tr"),e.innerHTML='<td colspan="3">-</td> '},m(r,n){g(r,e,n)},p:$,d(r){r&&b(e)}}}function fe(t){let e,r,n,l,o,i,s,f,u;return{c(){e=h("form"),r=h("input"),l=v(),o=h("input"),i=v(),s=h("input"),k(r,"type","hidden"),k(r,"name","id"),r.value=n=t[4].id,k(o,"type","hidden"),k(o,"name","instrumentCode"),o.value=t[1],k(s,"type","submit"),s.value="Cancel",k(e,"class","order-cancel"),k(e,"method","post"),k(e,"action","/orders/cancel")},m(c,a){g(c,e,a),p(e,r),p(e,l),p(e,o),p(e,i),p(e,s),f||(u=x(e,"submit",ee(t[2])),f=!0)},p(c,a){a&1&&n!==(n=c[4].id)&&(r.value=n),a&2&&(o.value=c[1])},d(c){c&&b(e),f=!1,u()}}}function ae(t){let e;function r(o,i){return o[4]==null?Ke:Je}let n=r(t),l=n(t);return{c(){l.c(),e=W()},m(o,i){l.m(o,i),g(o,e,i)},p(o,i){n===(n=r(o))&&l?l.p(o,i):(l.d(1),l=n(o),l&&(l.c(),l.m(e.parentNode,e)))},d(o){o&&b(e),l.d(o)}}}function Ve(t){let e;function r(o,i){return o[0].length===0?Ge:qe}let n=r(t),l=n(t);return{c(){l.c(),e=W()},m(o,i){l.m(o,i),g(o,e,i)},p(o,[i]){n===(n=r(o))&&l?l.p(o,i):(l.d(1),l=n(o),l&&(l.c(),l.m(e.parentNode,e)))},i:$,o:$,d(o){o&&b(e),l.d(o)}}}function Ye(t,e,r){const n=ne();let{bookEntryList:l}=e,{instrumentCode:o}=e;const i=s=>{const f=s.target.action,u=new FormData(s.target),c=new URLSearchParams;for(let a of u){const[d,_]=a;c.append(d,_)}fetch(f,{method:"POST",body:c}).then(a=>{n("order-canceled")})};return t.$$set=s=>{"bookEntryList"in s&&r(0,l=s.bookEntryList),"instrumentCode"in s&&r(1,o=s.instrumentCode)},[l,o,i]}class de extends T{constructor(e){super(),D(this,e,Ye,Ve,A,{bookEntryList:0,instrumentCode:1})}}function me(t){let e,r,n,l,o,i,s,f,u,c;return o=new de({props:{instrumentCode:t[0],bookEntryList:t[2]}}),o.$on("order-canceled",t[4]),u=new de({props:{instrumentCode:t[0],bookEntryList:t[1]}}),u.$on("order-canceled",t[5]),{c(){e=h("table"),r=h("thead"),r.innerHTML="<tr><th>Price</th> <th>Size</th> <th></th></tr>",n=v(),l=h("tbody"),P(o.$$.fragment),i=v(),s=h("tr"),s.innerHTML='<td colspan="3">Mid</td>',f=v(),P(u.$$.fragment)},m(a,d){g(a,e,d),p(e,r),p(e,n),p(e,l),O(o,l,null),p(l,i),p(l,s),p(l,f),O(u,l,null),c=!0},p(a,d){const _={};d&1&&(_.instrumentCode=a[0]),d&4&&(_.bookEntryList=a[2]),o.$set(_);const m={};d&1&&(m.instrumentCode=a[0]),d&2&&(m.bookEntryList=a[1]),u.$set(m)},i(a){c||(w(o.$$.fragment,a),w(u.$$.fragment,a),c=!0)},o(a){C(o.$$.fragment,a),C(u.$$.fragment,a),c=!1},d(a){a&&b(e),S(o),S(u)}}}function Qe(t){let e,r,n=t[1]!=null&&t[2]!=null&&me(t);return{c(){n&&n.c(),e=W()},m(l,o){n&&n.m(l,o),g(l,e,o),r=!0},p(l,[o]){l[1]!=null&&l[2]!=null?n?(n.p(l,o),o&6&&w(n,1)):(n=me(l),n.c(),w(n,1),n.m(e.parentNode,e)):n&&(ye(),C(n,1,1,()=>{n=null}),ke())},i(l){r||(w(n),r=!0)},o(l){C(n),r=!1},d(l){l&&b(e),n&&n.d(l)}}}function Xe(t,e,r){let n,l,{len:o=5}=e,{instrumentCode:i}=e;function s(c){return c=c.slice(0,o),c=c.concat(new Array(o-c.length)),c}te(()=>{let c=new WebSocket("ws://localhost:8081/market/data?instrumentCode="+i,"protocolOne");c.onmessage=a=>{var d=JSON.parse(a.data);r(1,n=s(d.bids)),r(2,l=s(d.asks).reverse())}});function f(c){oe.call(this,t,c)}function u(c){oe.call(this,t,c)}return t.$$set=c=>{"len"in c&&r(3,o=c.len),"instrumentCode"in c&&r(0,i=c.instrumentCode)},[i,n,l,o,f,u]}class Ze extends T{constructor(e){super(),D(this,e,Xe,Qe,A,{len:3,instrumentCode:0})}}function xe(t){let e,r,n;return{c(){e=h("form"),e.innerHTML='<label>Instrument<input type="text" name="instrumentCode" placeholder="SPY"/></label> <label>Amount<input type="text" name="amount" placeholder="10"/></label> <label>Price<input type="text" name="price" placeholder="$100"/></label> <input type="submit" name="buy" value="Buy"/> <input type="submit" name="sell" value="Sell"/>',k(e,"method","post"),k(e,"action","/orders/submit")},m(l,o){g(l,e,o),r||(n=x(e,"submit",ee(t[0])),r=!0)},p:$,i:$,o:$,d(l){l&&b(e),r=!1,n()}}}function et(t){const e=ne();return[n=>{const l=n.target.action,o=new FormData(n.target),i=new URLSearchParams;for(let f of o){const[u,c]=f;i.append(u,c)}let s=n.submitter.name==="buy"?"Buy":"Sell";i.append("side",s),fetch(l,{method:"POST",body:i}).then(f=>{n.target.reset(),e("submit-order",{})})}]}class tt extends T{constructor(e){super(),D(this,e,et,xe,A,{})}}function nt(t){let e;return{c(){e=h("a"),e.textContent="Login with Google",k(e,"href","/oauth2/authorization/google")},m(r,n){g(r,e,n)},p:$,i:$,o:$,d(r){r&&b(e)}}}function rt(t){let e,r,n,l,o,i,s,f,u,c,a,d,_,m,L;n=new Ze({props:{instrumentCode:"BTC/USD"}}),n.$on("order-canceled",t[3]),i=new tt({}),i.$on("submit-order",t[3]);function q(y){t[5](y)}let B={};return t[1]!==void 0&&(B.refresh=t[1]),c=new Ue({props:B}),J.push(()=>ve(c,"refresh",q)),m=new We({}),m.$on("deposit",t[2]),{c(){e=h("div"),r=h("div"),P(n.$$.fragment),l=v(),o=h("div"),P(i.$$.fragment),s=v(),f=h("div"),u=h("div"),P(c.$$.fragment),d=v(),_=h("div"),P(m.$$.fragment),k(e,"class","row"),k(f,"class","row")},m(y,j){g(y,e,j),p(e,r),O(n,r,null),p(e,l),p(e,o),O(i,o,null),g(y,s,j),g(y,f,j),p(f,u),O(c,u,null),p(f,d),p(f,_),O(m,_,null),L=!0},p(y,j){const re={};!a&&j&2&&(a=!0,re.refresh=y[1],ge(()=>a=!1)),c.$set(re)},i(y){L||(w(n.$$.fragment,y),w(i.$$.fragment,y),w(c.$$.fragment,y),w(m.$$.fragment,y),L=!0)},o(y){C(n.$$.fragment,y),C(i.$$.fragment,y),C(c.$$.fragment,y),C(m.$$.fragment,y),L=!1},d(y){y&&(b(e),b(s),b(f)),S(n),S(i),S(c),S(m)}}}function lt(t){let e,r,n,l,o,i,s,f;function u(m){t[4](m)}let c={};t[0]!==void 0&&(c.user=t[0]),n=new Re({props:c}),J.push(()=>ve(n,"user",u));const a=[rt,nt],d=[];function _(m,L){return m[0]!=null?0:1}return i=_(t),s=d[i]=a[i](t),{c(){e=h("main"),r=h("header"),P(n.$$.fragment),o=v(),s.c()},m(m,L){g(m,e,L),p(e,r),O(n,r,null),p(e,o),d[i].m(e,null),f=!0},p(m,[L]){const q={};!l&&L&1&&(l=!0,q.user=m[0],ge(()=>l=!1)),n.$set(q);let B=i;i=_(m),i===B?d[i].p(m,L):(ye(),C(d[B],1,1,()=>{d[B]=null}),ke(),s=d[i],s?s.p(m,L):(s=d[i]=a[i](m),s.c()),w(s,1),s.m(e,null))},i(m){f||(w(n.$$.fragment,m),w(s),f=!0)},o(m){C(n.$$.fragment,m),C(s),f=!1},d(m){m&&b(e),S(n),d[i].d()}}}function ot(t,e,r){let n,l;function o(){l()}function i(){l()}function s(u){n=u,r(0,n)}function f(u){l=u,r(1,l)}return[n,l,o,i,s,f]}class it extends T{constructor(e){super(),D(this,e,ot,lt,A,{})}}new it({target:document.getElementById("app")});
