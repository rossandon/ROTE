var Ee=Object.defineProperty;var Oe=(t,e,r)=>e in t?Ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var W=(t,e,r)=>(Oe(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();function y(){}function $e(t){return t()}function ue(){return Object.create(null)}function q(t){t.forEach($e)}function be(t){return typeof t=="function"}function D(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Pe(t){return Object.keys(t).length===0}function h(t,e){t.appendChild(e)}function g(t,e,r){t.insertBefore(e,r||null)}function b(t){t.parentNode&&t.parentNode.removeChild(t)}function ge(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function p(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function k(){return E(" ")}function V(){return E("")}function te(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function ne(t){return function(e){return e.preventDefault(),t.call(this,e)}}function v(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Se(t){return Array.from(t.childNodes)}function z(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ne(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}let F;function H(t){F=t}function ye(){if(!F)throw new Error("Function called outside component initialization");return F}function re(t){ye().$$.on_mount.push(t)}function ve(){const t=ye();return(e,r,{cancelable:n=!1}={})=>{const o=t.$$.callbacks[e];if(o){const i=Ne(e,r,{cancelable:n});return o.slice().forEach(l=>{l.call(t,i)}),!i.defaultPrevented}return!0}}const I=[],Y=[];let U=[];const Q=[],Ae=Promise.resolve();let X=!1;function De(){X||(X=!0,Ae.then(ke))}function Z(t){U.push(t)}function x(t){Q.push(t)}const J=new Set;let j=0;function ke(){if(j!==0)return;const t=F;do{try{for(;j<I.length;){const e=I[j];j++,H(e),Te(e.$$)}}catch(e){throw I.length=0,j=0,e}for(H(null),I.length=0,j=0;Y.length;)Y.pop()();for(let e=0;e<U.length;e+=1){const r=U[e];J.has(r)||(J.add(r),r())}U.length=0}while(I.length);for(;Q.length;)Q.pop()();X=!1,J.clear(),H(t)}function Te(t){if(t.fragment!==null){t.update(),q(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}function Be(t){const e=[],r=[];U.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),U=e}const G=new Set;let N;function we(){N={r:0,c:[],p:N}}function Le(){N.r||q(N.c),N=N.p}function L(t,e){t&&t.i&&(G.delete(t),t.i(e))}function C(t,e,r,n){if(t&&t.o){if(G.has(t))return;G.add(t),N.c.push(()=>{G.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function K(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ee(t,e,r){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}function A(t){t&&t.c()}function O(t,e,r){const{fragment:n,after_update:o}=t.$$;n&&n.m(e,r),Z(()=>{const i=t.$$.on_mount.map($e).filter(be);t.$$.on_destroy?t.$$.on_destroy.push(...i):q(i),t.$$.on_mount=[]}),o.forEach(Z)}function P(t,e){const r=t.$$;r.fragment!==null&&(Be(r.after_update),q(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Me(t,e){t.$$.dirty[0]===-1&&(I.push(t),De(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function T(t,e,r,n,o,i,l=null,s=[-1]){const a=F;H(t);const u=t.$$={fragment:null,ctx:[],props:i,update:y,not_equal:o,bound:ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:ue(),dirty:s,skip_bound:!1,root:e.target||a.$$.root};l&&l(u.root);let c=!1;if(u.ctx=r?r(t,e.props||{},(f,d,..._)=>{const m=_.length?_[0]:d;return u.ctx&&o(u.ctx[f],u.ctx[f]=m)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](m),c&&Me(t,f)),d}):[],u.update(),c=!0,q(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const f=Se(e.target);u.fragment&&u.fragment.l(f),f.forEach(b)}else u.fragment&&u.fragment.c();e.intro&&L(t.$$.fragment),O(t,e.target,e.anchor),ke()}H(a)}class B{constructor(){W(this,"$$");W(this,"$$set")}$destroy(){P(this,1),this.$destroy=y}$on(e,r){if(!be(r))return y;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!Pe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const je="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(je);function fe(t,e,r){const n=t.slice();return n[2]=e[r],n}function ce(t){let e,r,n=t[2]+"",o,i,l,s=t[0][t[2]]+"",a,u;return{c(){e=p("tr"),r=p("td"),o=E(n),i=k(),l=p("td"),a=E(s),u=k()},m(c,f){g(c,e,f),h(e,r),h(r,o),h(e,i),h(e,l),h(l,a),h(e,u)},p(c,f){f&1&&n!==(n=c[2]+"")&&z(o,n),f&1&&s!==(s=c[0][c[2]]+"")&&z(a,s)},d(c){c&&b(e)}}}function Ie(t){let e,r,n,o,i=K(Object.keys(t[0])),l=[];for(let s=0;s<i.length;s+=1)l[s]=ce(fe(t,i,s));return{c(){e=p("table"),r=p("thead"),r.innerHTML="<tr><th>Asset</th> <th>Balance</th></tr>",n=k(),o=p("tbody");for(let s=0;s<l.length;s+=1)l[s].c()},m(s,a){g(s,e,a),h(e,r),h(e,n),h(e,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(o,null)},p(s,[a]){if(a&1){i=K(Object.keys(s[0]));let u;for(u=0;u<i.length;u+=1){const c=fe(s,i,u);l[u]?l[u].p(c,a):(l[u]=ce(c),l[u].c(),l[u].m(o,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=i.length}},i:y,o:y,d(s){s&&b(e),ge(l,s)}}}function Ue(t,e,r){let n={};function o(){fetch("balances/list").then(i=>i.json()).then(i=>r(0,n=i))}return re(()=>{o()}),[n,o]}class Re extends B{constructor(e){super(),T(this,e,Ue,Ie,D,{refresh:1})}get refresh(){return this.$$.ctx[1]}}function ae(t){let e,r=t[0].name+"",n,o,i;return{c(){e=E("Hello, "),n=E(r),o=E(". "),i=p("a"),i.textContent="Logout",v(i,"href","/logout")},m(l,s){g(l,e,s),g(l,n,s),g(l,o,s),g(l,i,s)},p(l,s){s&1&&r!==(r=l[0].name+"")&&z(n,r)},d(l){l&&(b(e),b(n),b(o),b(i))}}}function He(t){let e,r=t[0]!=null&&ae(t);return{c(){r&&r.c(),e=V()},m(n,o){r&&r.m(n,o),g(n,e,o)},p(n,[o]){n[0]!=null?r?r.p(n,o):(r=ae(n),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null)},i:y,o:y,d(n){n&&b(e),r&&r.d(n)}}}async function ze(){try{const t=await fetch("system/whoami");if(!t.ok)throw new Error(`Error! status: ${t.status}`);return await t.json()}catch(t){return t instanceof Error?(console.log("error message: ",t.message),null):(console.log("unexpected error: ",t),null)}}function Fe(t,e,r){let{user:n=null}=e;return re(async()=>{r(0,n=await ze())}),t.$$set=o=>{"user"in o&&r(0,n=o.user)},[n]}class Ye extends B{constructor(e){super(),T(this,e,Fe,He,D,{user:0})}}function qe(t){let e,r,n;return{c(){e=p("form"),e.innerHTML='<label>Asset<input type="text" name="assetCode" placeholder="USD"/></label> <label>Amount<input type="text" name="amount" placeholder="100"/></label> <input type="submit" value="Deposit"/>',v(e,"method","post"),v(e,"action","/balances/deposit")},m(o,i){g(o,e,i),r||(n=te(e,"submit",ne(t[0])),r=!0)},p:y,i:y,o:y,d(o){o&&b(e),r=!1,n()}}}function Ge(t){const e=ve();return[n=>{const o=n.target.action,i=new FormData(n.target),l=new URLSearchParams;for(let s of i){const[a,u]=s;l.append(a,u)}fetch(o,{method:"POST",body:l}).then(s=>{n.target.reset(),e("deposit",{})})}]}class Ke extends B{constructor(e){super(),T(this,e,Ge,qe,D,{})}}function de(t,e,r){const n=t.slice();return n[3]=e[r],n}function Ve(t){let e,r=K(t[0]),n=[];for(let o=0;o<r.length;o+=1)n[o]=me(de(t,r,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=V()},m(o,i){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(o,i);g(o,e,i)},p(o,i){if(i&7){r=K(o[0]);let l;for(l=0;l<r.length;l+=1){const s=de(o,r,l);n[l]?n[l].p(s,i):(n[l]=me(s),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=r.length}},d(o){o&&b(e),ge(n,o)}}}function We(t){let e;return{c(){e=p("tr"),e.innerHTML='<td colspan="3">No entries.</td>'},m(r,n){g(r,e,n)},p:y,d(r){r&&b(e)}}}function he(t){let e,r,n,o,i,l,s,a,u;return{c(){e=p("form"),r=p("input"),o=k(),i=p("input"),l=k(),s=p("input"),v(r,"type","hidden"),v(r,"name","id"),r.value=n=t[3].id,v(i,"type","hidden"),v(i,"name","instrumentCode"),i.value=t[1],v(s,"type","submit"),s.value="Cancel",v(e,"class","order-cancel"),v(e,"method","post"),v(e,"action","/orders/cancel")},m(c,f){g(c,e,f),h(e,r),h(e,o),h(e,i),h(e,l),h(e,s),a||(u=te(e,"submit",ne(t[2])),a=!0)},p(c,f){f&1&&n!==(n=c[3].id)&&(r.value=n),f&2&&(i.value=c[1])},d(c){c&&b(e),a=!1,u()}}}function me(t){let e,r,n=t[3].price+"",o,i,l,s=t[3].size+"",a,u,c,f,d=t[3].canCancel&&he(t);return{c(){e=p("tr"),r=p("td"),o=E(n),i=k(),l=p("td"),a=E(s),u=k(),c=p("td"),d&&d.c(),f=k()},m(_,m){g(_,e,m),h(e,r),h(r,o),h(e,i),h(e,l),h(l,a),h(e,u),h(e,c),d&&d.m(c,null),h(e,f)},p(_,m){m&1&&n!==(n=_[3].price+"")&&z(o,n),m&1&&s!==(s=_[3].size+"")&&z(a,s),_[3].canCancel?d?d.p(_,m):(d=he(_),d.c(),d.m(c,null)):d&&(d.d(1),d=null)},d(_){_&&b(e),d&&d.d()}}}function Je(t){let e;function r(i,l){return i[0].length===0?We:Ve}let n=r(t),o=n(t);return{c(){o.c(),e=V()},m(i,l){o.m(i,l),g(i,e,l)},p(i,[l]){n===(n=r(i))&&o?o.p(i,l):(o.d(1),o=n(i),o&&(o.c(),o.m(e.parentNode,e)))},i:y,o:y,d(i){i&&b(e),o.d(i)}}}function Qe(t,e,r){let{bookEntryList:n}=e,{instrumentCode:o}=e;const i=l=>{const s=l.target.action,a=new FormData(l.target),u=new URLSearchParams;for(let c of a){const[f,d]=c;u.append(f,d)}fetch(s,{method:"POST",body:u}).then(c=>{})};return t.$$set=l=>{"bookEntryList"in l&&r(0,n=l.bookEntryList),"instrumentCode"in l&&r(1,o=l.instrumentCode)},[n,o,i]}class pe extends B{constructor(e){super(),T(this,e,Qe,Je,D,{bookEntryList:0,instrumentCode:1})}}function _e(t){let e,r,n,o,i,l,s,a,u,c;return i=new pe({props:{instrumentCode:t[0],bookEntryList:t[1].asks}}),u=new pe({props:{instrumentCode:t[0],bookEntryList:t[1].bids}}),{c(){e=p("table"),r=p("thead"),r.innerHTML="<tr><th>Price</th> <th>Size</th> <th></th></tr>",n=k(),o=p("tbody"),A(i.$$.fragment),l=k(),s=p("tr"),s.innerHTML='<td colspan="3">Mid</td>',a=k(),A(u.$$.fragment)},m(f,d){g(f,e,d),h(e,r),h(e,n),h(e,o),O(i,o,null),h(o,l),h(o,s),h(o,a),O(u,o,null),c=!0},p(f,d){const _={};d&1&&(_.instrumentCode=f[0]),d&2&&(_.bookEntryList=f[1].asks),i.$set(_);const m={};d&1&&(m.instrumentCode=f[0]),d&2&&(m.bookEntryList=f[1].bids),u.$set(m)},i(f){c||(L(i.$$.fragment,f),L(u.$$.fragment,f),c=!0)},o(f){C(i.$$.fragment,f),C(u.$$.fragment,f),c=!1},d(f){f&&b(e),P(i),P(u)}}}function Xe(t){let e,r,n=t[1]!=null&&_e(t);return{c(){n&&n.c(),e=V()},m(o,i){n&&n.m(o,i),g(o,e,i),r=!0},p(o,[i]){o[1]!=null?n?(n.p(o,i),i&2&&L(n,1)):(n=_e(o),n.c(),L(n,1),n.m(e.parentNode,e)):n&&(we(),C(n,1,1,()=>{n=null}),Le())},i(o){r||(L(n),r=!0)},o(o){C(n),r=!1},d(o){o&&b(e),n&&n.d(o)}}}function Ze(t,e,r){let n,{instrumentCode:o}=e;function i(){fetch(`book?instrument=${o}`).then(l=>l.json()).then(l=>{r(1,n=l)})}return re(()=>{i()}),t.$$set=l=>{"instrumentCode"in l&&r(0,o=l.instrumentCode)},[o,n,i]}class xe extends B{constructor(e){super(),T(this,e,Ze,Xe,D,{instrumentCode:0,refresh:2})}get refresh(){return this.$$.ctx[2]}}function et(t){let e,r,n;return{c(){e=p("form"),e.innerHTML='<label>Instrument<input type="text" name="instrumentCode" placeholder="SPY"/></label> <label>Amount<input type="text" name="amount" placeholder="10"/></label> <label>Price<input type="text" name="price" placeholder="$100"/></label> <input type="submit" name="buy" value="Buy"/> <input type="submit" name="sell" value="Sell"/>',v(e,"method","post"),v(e,"action","/orders/submit")},m(o,i){g(o,e,i),r||(n=te(e,"submit",ne(t[0])),r=!0)},p:y,i:y,o:y,d(o){o&&b(e),r=!1,n()}}}function tt(t){const e=ve();return[n=>{const o=n.target.action,i=new FormData(n.target),l=new URLSearchParams;for(let a of i){const[u,c]=a;l.append(u,c)}let s=n.submitter.name==="buy"?"Buy":"Sell";l.append("side",s),fetch(o,{method:"POST",body:l}).then(a=>{n.target.reset(),e("submit-order",{})})}]}class nt extends B{constructor(e){super(),T(this,e,tt,et,D,{})}}function rt(t){let e;return{c(){e=p("a"),e.textContent="Login with Google",v(e,"href","/oauth2/authorization/google")},m(r,n){g(r,e,n)},p:y,i:y,o:y,d(r){r&&b(e)}}}function ot(t){let e,r,n,o,i,l,s,a,u,c,f,d,_,m,w,S;function R($){t[6]($)}let oe={instrumentCode:"SPY"};t[2]!==void 0&&(oe.refresh=t[2]),n=new xe({props:oe}),Y.push(()=>ee(n,"refresh",R)),s=new nt({}),s.$on("submit-order",t[4]);function Ce($){t[7]($)}let le={};return t[1]!==void 0&&(le.refresh=t[1]),f=new Re({props:le}),Y.push(()=>ee(f,"refresh",Ce)),w=new Ke({}),w.$on("deposit",t[3]),{c(){e=p("div"),r=p("div"),A(n.$$.fragment),i=k(),l=p("div"),A(s.$$.fragment),a=k(),u=p("div"),c=p("div"),A(f.$$.fragment),_=k(),m=p("div"),A(w.$$.fragment),v(e,"class","row"),v(u,"class","row")},m($,M){g($,e,M),h(e,r),O(n,r,null),h(e,i),h(e,l),O(s,l,null),g($,a,M),g($,u,M),h(u,c),O(f,c,null),h(u,_),h(u,m),O(w,m,null),S=!0},p($,M){const ie={};!o&&M&4&&(o=!0,ie.refresh=$[2],x(()=>o=!1)),n.$set(ie);const se={};!d&&M&2&&(d=!0,se.refresh=$[1],x(()=>d=!1)),f.$set(se)},i($){S||(L(n.$$.fragment,$),L(s.$$.fragment,$),L(f.$$.fragment,$),L(w.$$.fragment,$),S=!0)},o($){C(n.$$.fragment,$),C(s.$$.fragment,$),C(f.$$.fragment,$),C(w.$$.fragment,$),S=!1},d($){$&&(b(e),b(a),b(u)),P(n),P(s),P(f),P(w)}}}function lt(t){let e,r,n,o,i,l,s,a;function u(m){t[5](m)}let c={};t[0]!==void 0&&(c.user=t[0]),n=new Ye({props:c}),Y.push(()=>ee(n,"user",u));const f=[ot,rt],d=[];function _(m,w){return m[0]!=null?0:1}return l=_(t),s=d[l]=f[l](t),{c(){e=p("main"),r=p("header"),A(n.$$.fragment),i=k(),s.c()},m(m,w){g(m,e,w),h(e,r),O(n,r,null),h(e,i),d[l].m(e,null),a=!0},p(m,[w]){const S={};!o&&w&1&&(o=!0,S.user=m[0],x(()=>o=!1)),n.$set(S);let R=l;l=_(m),l===R?d[l].p(m,w):(we(),C(d[R],1,1,()=>{d[R]=null}),Le(),s=d[l],s?s.p(m,w):(s=d[l]=f[l](m),s.c()),L(s,1),s.m(e,null))},i(m){a||(L(n.$$.fragment,m),L(s),a=!0)},o(m){C(n.$$.fragment,m),C(s),a=!1},d(m){m&&b(e),P(n),d[l].d()}}}function it(t,e,r){let n,o,i;function l(){o()}function s(){o(),i()}function a(f){n=f,r(0,n)}function u(f){i=f,r(2,i)}function c(f){o=f,r(1,o)}return[n,o,i,l,s,a,u,c]}class st extends B{constructor(e){super(),T(this,e,it,lt,D,{})}}new st({target:document.getElementById("app")});
